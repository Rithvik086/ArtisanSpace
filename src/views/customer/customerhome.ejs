<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Home</title>
  <link rel="stylesheet" href="/navbar2.css" />
  <link rel="stylesheet" href="/customer/customerHome.css">
  <link rel="stylesheet" href="/footer.css" />
  <link rel="stylesheet" href="/customer/homePageStatusTab.css">
  <!-- // new style -->

  </style>
</head>

<body>
  <%- include('../partials/navbar2', { role }) %>

  <main>
    <div class="mainimage">
      <h3>We Make Things With love</h3>
      <h1>HANDMADE</h1>
      <p>
        Lorem ipsum, dolor sit amet consectetur adipisicing elit. Sapiente
        eligendi repudiandae vero quis? Nostrum provident repellendus alias
        incidunt, perferendis aut blanditiis dicta nisi, magni enim sint
        magnam quidem eius temporibus maxime facere?
      </p>
    </div>
    <div class="seconelem">
      <img src="/images/landingpage/artisan.jpg" alt="" srcset="" />
      <div class="welcomecontent">
        <h1>Welcome To ArtisanSpace</h1>
        <p>
          It is a long established fact that a reader will be distracted by
          the readable content of a page when looking at its layout. The point
          of using Lorem Ipsum is that it has a more-or-less normal
          distribution of letters, as opposed to using 'Content here, content
          here', making it look like readable English. Many desktop publishing
          packages and web page editors now use Lorem Ipsum as their default
          model text, and a search for 'lorem ipsum' will uncover.
        </p>
      </div>
    </div>
    <div class="slider-container">
      <div class="slider">
        <% products.forEach(product => {%>
        <a href="/products/<%= product._id.toString() %>">
          <img src="<%= product.image %>" alt="<%= product.name %>">
        </a>
        <%}) %>
      </div>
    </div>
    <!-- // new tabs -->

    <div class="statusTab">

      <div class="tabs">
        <button class="tab-btn active" data-tab="orders">Orders</button>
        <button class="tab-btn" data-tab="requests">Custom Requests</button>
        <button class="tab-btn" data-tab="workshops">Workshops</button>
      </div>

      <div class="tab-content active" id="orders">
        <h2>Your Orders</h2>
        <div class="cards-container">
          <% if (orders && orders.length > 0) { %>
          <% orders.forEach(order => { %>
          <div class="card" data-id="<%= order._id.toString() %>">
            <div class="card-header">
              <h3>Order #<%= order._id.toString().slice(-6).toUpperCase() %></h3>
              <span class="status <%= order.status.toLowerCase() %>"><%= order.status %></span>
            </div>
            <div class="card-body">
              <p><strong>Products:</strong></p>
              <ul class="order-products-list">
                <% order.products.forEach(product => { %>
                <li>
                  <div class="product-item">
                    <div class="product-image">
                      <img src="<%= product.productId.image %>" alt="<%= product.productId.name %>">
                    </div>
                    <div class="product-details">
                      <strong><%= product.productId.name %></strong>
                      <span class="quantity">x<%= product.quantity %></span>
                      <span class="price">₹<%= (product.productId.newPrice * product.quantity).toFixed(2) %></span>
                    </div>
                  </div>
                </li>
                <% }) %>
              </ul>
              <div class="order-summary">
                <p><strong>Total:</strong> ₹<%= order.money.toFixed(2) %></p>
                <p><strong>Date:</strong> <%= new Date(order.purchasedAt).toLocaleDateString('en-IN') %></p>
              </div>
            </div>
            <div class="card-footer">
              <% if (order.status === 'delivered') { %>
              <button class="btn primary review-btn" data-orderid="<%= order._id.toString() %>">Write Review</button>
              <% } else if (order.status === 'pending' || order.status === 'processing') { %>
              <div class="order-status-info">
                <p>Status: <strong><%= order.status %></strong></p>
              </div>
              <% } %>
            </div>
          </div>
          <% }) %>
          <% } else { %>
          <div class="empty-state">
            <p>You don't have any orders yet.</p>
            <a href="/customer/store"><button class="btn primary">Shop Now</button></a>
          </div>
          <% } %>
        </div>
      </div>

      <div class="tab-content" id="requests">
        <h2>Your Custom Requests</h2>
        <div class="cards-container">
          <% if (requests && requests.length > 0) { %>
          <% requests.forEach(request => { %>
          <div class="card">
            <div class="card-header">
              <h3><%= request.title %></h3>
              <span class="status <%= request.isAccepted ? 'accepted' : 'pending' %>">
                <%= request.isAccepted ? 'Accepted' : 'Pending' %>
              </span>
            </div>
            <% if (request.image) { %>
            <div class="card-image">
              <img src="<%= request.image %>" alt="<%= request.title %>">
            </div>
            <% } %>
            <div class="card-body">
              <p><strong>Type:</strong> <%= request.type %></p>
              <p><strong>Description:</strong> <%= request.description %></p>
              <p><strong>Budget:</strong> <%= request.budget %></p>
              <p><strong>Required By:</strong> <%= request.requiredBy %></p>
            </div>
            <div class="card-footer">


            </div>
          </div>
          <% }) %>
          <% } else { %>
          <div class="empty-state">
            <p>You don't have any custom requests yet.</p>

          </div>
          <% } %>
        </div>
      </div>

      <div class="tab-content" id="workshops">
        <h2>Your Workshops</h2>
        <div class="cards-container">
          <% if (workshops && workshops.length > 0) { %>
          <% workshops.forEach(workshop => { %>
          <div class="card">
            <div class="card-header">
              <h3><%= workshop.workshopTitle %></h3>
              <span class="status <%= workshop.status === 1 ? 'accepted' : 'pending' %>">
                <%= workshop.status === 1 ? 'Accepted' : 'Pending' %>
              </span>
            </div>
            <div class="card-body">
              <p><strong>Description:</strong> <%= workshop.workshopDescription %></p>
              <p><strong>Date:</strong> <%= workshop.date %></p>
              <p><strong>Time:</strong> <%= workshop.time %></p>
              <% if (workshop.status === 1 && workshop.acceptedAt) { %>
              <p><strong>Accepted On:</strong> <%= workshop.acceptedAt %></p>
              <% } %>
            </div>
            <div class="card-footer">


            </div>
          </div>
          <% }) %>
          <% } else { %>
          <div class="empty-state">
            <p>You don't have any workshops yet.</p>

          </div>
          <% } %>
        </div>
      </div>
    </div>
    </div>
  </main>
  <%- include("../partials/footer") %>
  <script>
    document.addEventListener("DOMContentLoaded", () => {

      document.querySelectorAll(".card").forEach((card) => {
        card.addEventListener("click", () => {
          const orderId = card.getAttribute("data-id");
          window.location.href = `/customer/orders/${orderId}`;
        });
      });
      const slider = document.querySelector(".slider");

      function moveSlider() {
        const firstImage = slider.firstElementChild;
        const imgWidth = firstImage.offsetWidth + 20;

        slider.style.transition = "transform 0.7s ease-in-out";
        slider.style.transform = `translateX(-${imgWidth}px)`;

        setTimeout(() => {
          slider.appendChild(firstImage);
          slider.style.transition = "none";
          slider.style.transform = "translateX(0)";
        }, 700);
      }

      setInterval(moveSlider, 4000);
    });
  </script>

  <!-- // new script  -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Tab switching functionality
      const tabButtons = document.querySelectorAll('.tab-btn');
      const tabContents = document.querySelectorAll('.tab-content');

      tabButtons.forEach(button => {
        button.addEventListener('click', () => {
          // Remove active class from all buttons and contents
          tabButtons.forEach(btn => btn.classList.remove('active'));
          tabContents.forEach(content => content.classList.remove('active'));

          // Add active class to clicked button and corresponding content
          button.classList.add('active');
          const tabId = button.getAttribute('data-tab');
          document.getElementById(tabId).classList.add('active');
        });
      });



    });
  </script>
</body>

</html>